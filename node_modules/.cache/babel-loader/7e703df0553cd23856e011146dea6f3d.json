{"remainingRequest":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js!/home/dev/work/client-auth/src/api/integrations/storage/storage.js","dependencies":[{"path":"/home/dev/work/client-auth/src/api/integrations/storage/storage.js","mtime":1580975886426},{"path":"/home/dev/work/client-auth/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport _defineProperty from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport instance from \"../../instance\";\nimport configuration from \"../../openAPIConfig\";\nimport { BackendProfileServiceApiFactory } from 'webitel-sdk';\nimport eventBus from \"../../../utils/eventBus\";\nimport sanitizer from \"../../utils/sanitizer\";\nimport deepCopy from 'deep-copy';\nimport store from \"../../../store/store\";\nvar storageService = new BackendProfileServiceApiFactory(configuration, '', instance);\nvar fieldsToSend = ['domainId', 'name', 'maxSize', 'priority', 'properties', 'expireDays', 'type'];\nvar storageTypes = {\n  local: 'local',\n  s3: 's3',\n  g_drive: 'drive',\n  drop_box: 'dropbox'\n};\nexport var AWSRegions = [{\n  name: 'EU (Frankfurt)',\n  value: 'eu-central-1'\n}, {\n  name: 'EU (Ireland)',\n  value: 'eu-west-1'\n}, {\n  name: 'EU (London)',\n  value: 'eu-west-2'\n}, {\n  name: 'EU (Paris)',\n  value: 'eu-west-3'\n}, {\n  name: 'EU (Stockholm)',\n  value: 'eu-north-1'\n}, {\n  name: 'Asia Pacific (Hong Kong)',\n  value: 'ap-east-1'\n}, {\n  name: 'Asia Pacific (Mumbai)',\n  value: 'ap-south-1'\n}, {\n  name: 'Asia Pacific (Osaka-Local)',\n  value: 'ap-northeast-3'\n}, {\n  name: 'Asia Pacific (Seoul)',\n  value: 'ap-northeast-2'\n}, {\n  name: 'Asia Pacific (Singapore)',\n  value: 'ap-southeast-1'\n}, {\n  name: 'Asia Pacific (Sydney)',\n  value: 'ap-southeast-2'\n}, {\n  name: 'Asia Pacific (Tokyo)',\n  value: 'ap-northeast-1'\n}, {\n  name: 'US East (Ohio)',\n  value: 'us-east-2'\n}, {\n  name: 'US East (N. Virginia)',\n  value: 'us-east-1'\n}, {\n  name: 'US West (N. California)',\n  value: 'us-west-1'\n}, {\n  name: 'US West (Oregon)',\n  value: 'us-west-2'\n}, {\n  name: 'Canada (Central)',\n  value: 'cn-north-1'\n}, {\n  name: 'China (Ningxia)',\n  value: 'cn-northwest-1'\n}, {\n  name: 'Middle East (Bahrain)',\n  value: 'me-south-1'\n}, {\n  name: 'South America (Sao Paulo)',\n  value: 'sa-east-1'\n}, {\n  name: 'AWS GovCloud (US-East)',\n  value: 'us-gov-east-1'\n}, {\n  name: 'AWS GovCloud (US-West)',\n  value: 'us-gov-west-1'\n}];\nexport var DigitalOceanRegions = [{\n  name: 'New York City, United States (NYC1)',\n  value: 'NYC1'\n}, {\n  name: 'New York City, United States (NYC2)',\n  value: 'NYC2'\n}, {\n  name: 'New York City, United States (NYC3)',\n  value: 'NYC3'\n}, {\n  name: 'Amsterdam, the Netherlands 9 (AMS1)',\n  value: 'AMS1'\n}, {\n  name: 'Amsterdam, the Netherlands 9 (AMS2)',\n  value: 'AMS2'\n}, {\n  name: 'San Francisco, United States (SFO1)',\n  value: 'SFO1'\n}, {\n  name: 'San Francisco, United States (SFO2)',\n  value: 'SFO2'\n}, {\n  name: 'Singapore (SGP1)',\n  value: 'SGP1'\n}, {\n  name: 'London, United Kingdom (LON1)',\n  value: 'LON1'\n}, {\n  name: 'Frankfurt, Germany (FRA1)',\n  value: 'FRA1'\n}, {\n  name: 'Toronto, Canada (TOR1)',\n  value: 'TOR1'\n}, {\n  name: 'Bangalore, India (BLR1)',\n  value: 'BLR1'\n}];\nexport var getStorageList =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee() {\n    var page,\n        size,\n        search,\n        domainId,\n        defaultObject,\n        response,\n        _args = arguments;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            page = _args.length > 0 && _args[0] !== undefined ? _args[0] : 0;\n            size = _args.length > 1 && _args[1] !== undefined ? _args[1] : 10;\n            search = _args.length > 2 ? _args[2] : undefined;\n            domainId = store.state.userinfo.domainId || undefined;\n            if (search && search.slice(-1) !== '*') search += '*';\n            defaultObject = {\n              _isSelected: false,\n              enabled: false\n            };\n            _context.prev = 6;\n            _context.next = 9;\n            return storageService.searchBackendProfile(page, size, search, domainId);\n\n          case 9:\n            response = _context.sent;\n\n            if (!response.items) {\n              _context.next = 12;\n              break;\n            }\n\n            return _context.abrupt(\"return\", response.items.map(function (item) {\n              return _objectSpread({}, defaultObject, {}, item, {\n                type: storageTypes[item.type]\n              });\n            }));\n\n          case 12:\n            return _context.abrupt(\"return\", []);\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](6);\n            throw _context.t0;\n\n          case 18:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[6, 15]]);\n  }));\n\n  return function getStorageList() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var getStorage =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee2(id) {\n    var domainId, defaultObject, response;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            domainId = store.state.userinfo.domainId || undefined;\n            defaultObject = {\n              priority: 0,\n              _dirty: false\n            };\n            _context2.prev = 2;\n            _context2.next = 5;\n            return storageService.readBackendProfile(id, domainId);\n\n          case 5:\n            response = _context2.sent;\n\n            if (response.properties.region) {\n              if (response.properties.endpoint.includes('aws')) {\n                response.properties.region = AWSRegions.find(function (item) {\n                  return item.value === response.properties.region;\n                });\n              } else if (response.properties.endpoint.includes('digitalocean')) {\n                response.properties.region = DigitalOceanRegions.find(function (item) {\n                  return item.value === response.properties.region;\n                });\n              }\n            }\n\n            return _context2.abrupt(\"return\", _objectSpread({}, defaultObject, {}, response, {\n              type: storageTypes[response.type]\n            }));\n\n          case 10:\n            _context2.prev = 10;\n            _context2.t0 = _context2[\"catch\"](2);\n            throw _context2.t0;\n\n          case 13:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[2, 10]]);\n  }));\n\n  return function getStorage(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var addStorage =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee3(item) {\n    var itemCopy, response;\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            itemCopy.domainId = store.state.userinfo.domainId || undefined;\n\n            if (itemCopy.properties.region && itemCopy.properties.region.value) {\n              itemCopy.properties.region = itemCopy.properties.region.value;\n            }\n\n            itemCopy.type = Object.keys(storageTypes).find(function (key) {\n              return storageTypes[key] === itemCopy.type;\n            });\n            sanitizer(itemCopy, fieldsToSend);\n            _context3.prev = 5;\n            _context3.next = 8;\n            return storageService.createBackendProfile(itemCopy);\n\n          case 8:\n            response = _context3.sent;\n            eventBus.$emit('notificationInfo', 'Sucessfully added');\n            return _context3.abrupt(\"return\", response.id);\n\n          case 13:\n            _context3.prev = 13;\n            _context3.t0 = _context3[\"catch\"](5);\n            throw _context3.t0;\n\n          case 16:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[5, 13]]);\n  }));\n\n  return function addStorage(_x2) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var patchStorage =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee4(id, item) {\n    var itemCopy;\n    return regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            itemCopy.domainId = store.state.userinfo.domainId || undefined;\n            sanitizer(itemCopy, fieldsToSend);\n            _context4.prev = 3;\n            _context4.next = 6;\n            return storageService.patchBackendProfile(id, itemCopy);\n\n          case 6:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context4.next = 12;\n            break;\n\n          case 9:\n            _context4.prev = 9;\n            _context4.t0 = _context4[\"catch\"](3);\n            throw _context4.t0;\n\n          case 12:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[3, 9]]);\n  }));\n\n  return function patchStorage(_x3, _x4) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var updateStorage =\n/*#__PURE__*/\nfunction () {\n  var _ref5 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee5(id, item) {\n    var itemCopy;\n    return regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            itemCopy.domainId = store.state.userinfo.domainId || undefined;\n\n            if (itemCopy.properties.region && itemCopy.properties.region.value) {\n              itemCopy.properties.region = itemCopy.properties.region.value;\n            }\n\n            delete itemCopy.type;\n            sanitizer(itemCopy, fieldsToSend);\n            _context5.prev = 5;\n            _context5.next = 8;\n            return storageService.updateBackendProfile(id, itemCopy);\n\n          case 8:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context5.next = 14;\n            break;\n\n          case 11:\n            _context5.prev = 11;\n            _context5.t0 = _context5[\"catch\"](5);\n            throw _context5.t0;\n\n          case 14:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, null, [[5, 11]]);\n  }));\n\n  return function updateStorage(_x5, _x6) {\n    return _ref5.apply(this, arguments);\n  };\n}();\nexport var deleteStorage =\n/*#__PURE__*/\nfunction () {\n  var _ref6 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee6(id) {\n    var domainId;\n    return regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            domainId = store.state.userinfo.domainId || undefined;\n            _context6.prev = 1;\n            _context6.next = 4;\n            return storageService.deleteBackendProfile(id, domainId);\n\n          case 4:\n            _context6.next = 9;\n            break;\n\n          case 6:\n            _context6.prev = 6;\n            _context6.t0 = _context6[\"catch\"](1);\n            throw _context6.t0;\n\n          case 9:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6, null, [[1, 6]]);\n  }));\n\n  return function deleteStorage(_x7) {\n    return _ref6.apply(this, arguments);\n  };\n}();",{"version":3,"sources":["/home/dev/work/client-auth/src/api/integrations/storage/storage.js"],"names":["instance","configuration","BackendProfileServiceApiFactory","eventBus","sanitizer","deepCopy","store","storageService","fieldsToSend","storageTypes","local","s3","g_drive","drop_box","AWSRegions","name","value","DigitalOceanRegions","getStorageList","page","size","search","domainId","state","userinfo","undefined","slice","defaultObject","_isSelected","enabled","searchBackendProfile","response","items","map","item","type","getStorage","id","priority","_dirty","readBackendProfile","properties","region","endpoint","includes","find","addStorage","itemCopy","Object","keys","key","createBackendProfile","$emit","patchStorage","patchBackendProfile","updateStorage","updateBackendProfile","deleteStorage","deleteBackendProfile"],"mappings":"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","sourcesContent":["import instance from '../../instance';\nimport configuration from '../../openAPIConfig';\nimport {BackendProfileServiceApiFactory} from 'webitel-sdk';\nimport eventBus from \"../../../utils/eventBus\";\nimport sanitizer from \"../../utils/sanitizer\";\nimport deepCopy from 'deep-copy';\nimport store from '../../../store/store';\n\nconst storageService = new BackendProfileServiceApiFactory\n(configuration, '', instance);\n\nconst fieldsToSend = ['domainId', 'name', 'maxSize', 'priority', 'properties', 'expireDays', 'type',];\nconst storageTypes = {local: 'local', s3: 's3', g_drive: 'drive', drop_box: 'dropbox',};\nexport const AWSRegions = [\n    {name: 'EU (Frankfurt)', value: 'eu-central-1'},\n    {name: 'EU (Ireland)', value: 'eu-west-1'},\n    {name: 'EU (London)', value: 'eu-west-2'},\n    {name: 'EU (Paris)', value: 'eu-west-3'},\n    {name: 'EU (Stockholm)', value: 'eu-north-1'},\n    {name: 'Asia Pacific (Hong Kong)', value: 'ap-east-1'},\n    {name: 'Asia Pacific (Mumbai)', value: 'ap-south-1'},\n    {name: 'Asia Pacific (Osaka-Local)', value: 'ap-northeast-3'},\n    {name: 'Asia Pacific (Seoul)', value: 'ap-northeast-2'},\n    {name: 'Asia Pacific (Singapore)', value: 'ap-southeast-1'},\n    {name: 'Asia Pacific (Sydney)', value: 'ap-southeast-2'},\n    {name: 'Asia Pacific (Tokyo)', value: 'ap-northeast-1'},\n    {name: 'US East (Ohio)', value: 'us-east-2'},\n    {name: 'US East (N. Virginia)', value: 'us-east-1'},\n    {name: 'US West (N. California)', value: 'us-west-1'},\n    {name: 'US West (Oregon)', value: 'us-west-2'},\n    {name: 'Canada (Central)', value: 'cn-north-1'},\n    {name: 'China (Ningxia)', value: 'cn-northwest-1'},\n    {name: 'Middle East (Bahrain)', value: 'me-south-1'},\n    {name: 'South America (Sao Paulo)', value: 'sa-east-1'},\n    {name: 'AWS GovCloud (US-East)', value: 'us-gov-east-1'},\n    {name: 'AWS GovCloud (US-West)', value: 'us-gov-west-1'},\n];\nexport const DigitalOceanRegions = [\n    {name: 'New York City, United States (NYC1)', value: 'NYC1'},\n    {name: 'New York City, United States (NYC2)', value: 'NYC2'},\n    {name: 'New York City, United States (NYC3)', value: 'NYC3'},\n    {name: 'Amsterdam, the Netherlands 9 (AMS1)', value: 'AMS1'},\n    {name: 'Amsterdam, the Netherlands 9 (AMS2)', value: 'AMS2'},\n    {name: 'San Francisco, United States (SFO1)', value: 'SFO1'},\n    {name: 'San Francisco, United States (SFO2)', value: 'SFO2'},\n    {name: 'Singapore (SGP1)', value: 'SGP1'},\n    {name: 'London, United Kingdom (LON1)', value: 'LON1'},\n    {name: 'Frankfurt, Germany (FRA1)', value: 'FRA1'},\n    {name: 'Toronto, Canada (TOR1)', value: 'TOR1'},\n    {name: 'Bangalore, India (BLR1)', value: 'BLR1'},\n];\n\nexport const getStorageList = async (page = 0, size = 10, search) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    if (search && search.slice(-1) !== '*') search += '*';\n    const defaultObject = {\n        _isSelected: false,\n        enabled: false,\n    };\n\n    try {\n        const response = await storageService.searchBackendProfile(page, size, search, domainId);\n        if (response.items) {\n            return response.items.map(item => {\n                return {\n                    ...defaultObject,\n                    ...item,\n                    type: storageTypes[item.type],\n                }\n            });\n        }\n        return [];\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const getStorage = async (id) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    const defaultObject = {\n        priority: 0,\n        _dirty: false,\n    };\n    try {\n        let response = await storageService.readBackendProfile(id, domainId);\n        if (response.properties.region) {\n            if (response.properties.endpoint.includes('aws')) {\n                response.properties.region = AWSRegions.find(item => item.value === response.properties.region);\n            } else if (response.properties.endpoint.includes('digitalocean')) {\n                response.properties.region = DigitalOceanRegions.find(item => item.value === response.properties.region);\n            }\n        }\n        return {\n            ...defaultObject,\n            ...response,\n            type: storageTypes[response.type],\n        };\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const addStorage = async (item) => {\n    let itemCopy = deepCopy(item);\n    itemCopy.domainId = store.state.userinfo.domainId || undefined;\n    if (itemCopy.properties.region && itemCopy.properties.region.value) {\n        itemCopy.properties.region = itemCopy.properties.region.value;\n    }\n    itemCopy.type = Object.keys(storageTypes).find(key => storageTypes[key] === itemCopy.type);\n    sanitizer(itemCopy, fieldsToSend);\n    try {\n        const response = await storageService.createBackendProfile(itemCopy);\n        eventBus.$emit('notificationInfo', 'Sucessfully added');\n        return response.id;\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const patchStorage = async (id, item) => {\n    let itemCopy = deepCopy(item);\n    itemCopy.domainId = store.state.userinfo.domainId || undefined;\n    sanitizer(itemCopy, fieldsToSend);\n    try {\n        await storageService.patchBackendProfile(id, itemCopy);\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const updateStorage = async (id, item) => {\n    let itemCopy = deepCopy(item);\n    itemCopy.domainId = store.state.userinfo.domainId || undefined;\n    if (itemCopy.properties.region && itemCopy.properties.region.value) {\n        itemCopy.properties.region = itemCopy.properties.region.value;\n    }\n    delete itemCopy.type;\n    sanitizer(itemCopy, fieldsToSend);\n\n    try {\n        await storageService.updateBackendProfile(id, itemCopy);\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const deleteStorage = async (id) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    try {\n        await storageService.deleteBackendProfile(id, domainId);\n    } catch (err) {\n        throw err;\n    }\n};"]}]}