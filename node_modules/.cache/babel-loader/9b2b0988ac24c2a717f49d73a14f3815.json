{"remainingRequest":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js!/home/dev/work/client-auth/src/api/contact-center/agents/agents.js","dependencies":[{"path":"/home/dev/work/client-auth/src/api/contact-center/agents/agents.js","mtime":1581692556423},{"path":"/home/dev/work/client-auth/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport instance from \"../../instance\";\nimport configuration from \"../../openAPIConfig\";\nimport { AgentServiceApiFactory } from 'webitel-sdk';\nimport eventBus from \"../../../utils/eventBus\";\nimport sanitizer from \"../../utils/sanitizer\";\nimport { coerceObjectPermissionsResponse } from \"../../permissions/objects/objects\";\nimport store from \"../../../store/store\";\nimport deepCopy from \"deep-copy\";\nvar agentService = new AgentServiceApiFactory(configuration, '', instance);\nvar BASE_URL = '/call_center/agents';\nvar fieldsToSend = ['domainId', 'user', 'description'];\nexport var getAgentsList =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee() {\n    var page,\n        size,\n        search,\n        domainId,\n        defaultObject,\n        response,\n        _args = arguments;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            page = _args.length > 0 && _args[0] !== undefined ? _args[0] : 0;\n            size = _args.length > 1 && _args[1] !== undefined ? _args[1] : 10;\n            search = _args.length > 2 ? _args[2] : undefined;\n            domainId = store.state.userinfo.domainId || undefined;\n            defaultObject = {\n              _isSelected: false\n            };\n            if (search && search.slice(-1) !== '*') search += '*';\n            _context.prev = 6;\n            _context.next = 9;\n            return agentService.searchAgent(page, size, search, domainId);\n\n          case 9:\n            response = _context.sent;\n\n            if (!response.items) {\n              _context.next = 12;\n              break;\n            }\n\n            return _context.abrupt(\"return\", response.items.map(function (item) {\n              return _objectSpread({}, defaultObject, {}, item);\n            }));\n\n          case 12:\n            return _context.abrupt(\"return\", []);\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](6);\n            throw _context.t0;\n\n          case 18:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[6, 15]]);\n  }));\n\n  return function getAgentsList() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var getAgent =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee2(id) {\n    var domainId, defaultObject, response;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            domainId = store.state.userinfo.domainId || undefined;\n            defaultObject = {\n              _dirty: false\n            };\n            _context2.prev = 2;\n            _context2.next = 5;\n            return agentService.readAgent(id, domainId);\n\n          case 5:\n            response = _context2.sent;\n            return _context2.abrupt(\"return\", _objectSpread({}, defaultObject, {}, response));\n\n          case 9:\n            _context2.prev = 9;\n            _context2.t0 = _context2[\"catch\"](2);\n            throw _context2.t0;\n\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[2, 9]]);\n  }));\n\n  return function getAgent(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var addAgent =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee3(item) {\n    var itemCopy, response;\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            itemCopy.domainId = store.state.userinfo.domainId || undefined;\n            sanitizer(itemCopy, fieldsToSend);\n            _context3.prev = 3;\n            _context3.next = 6;\n            return agentService.createAgent(itemCopy);\n\n          case 6:\n            response = _context3.sent;\n            eventBus.$emit('notificationInfo', 'Sucessfully added');\n            return _context3.abrupt(\"return\", response.id);\n\n          case 11:\n            _context3.prev = 11;\n            _context3.t0 = _context3[\"catch\"](3);\n            throw _context3.t0;\n\n          case 14:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[3, 11]]);\n  }));\n\n  return function addAgent(_x2) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var updateAgent =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee4(id, item) {\n    var itemCopy;\n    return regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            itemCopy.domainId = store.state.userinfo.domainId || undefined;\n            sanitizer(itemCopy, fieldsToSend);\n            _context4.prev = 3;\n            _context4.next = 6;\n            return agentService.updateAgent(id, itemCopy);\n\n          case 6:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context4.next = 12;\n            break;\n\n          case 9:\n            _context4.prev = 9;\n            _context4.t0 = _context4[\"catch\"](3);\n            throw _context4.t0;\n\n          case 12:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[3, 9]]);\n  }));\n\n  return function updateAgent(_x3, _x4) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var deleteAgent =\n/*#__PURE__*/\nfunction () {\n  var _ref5 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee5(id) {\n    var domainId;\n    return regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            domainId = store.state.userinfo.domainId || undefined;\n            _context5.prev = 1;\n            _context5.next = 4;\n            return agentService.deleteAgent(id, domainId);\n\n          case 4:\n            _context5.next = 9;\n            break;\n\n          case 6:\n            _context5.prev = 6;\n            _context5.t0 = _context5[\"catch\"](1);\n            throw _context5.t0;\n\n          case 9:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, null, [[1, 6]]);\n  }));\n\n  return function deleteAgent(_x5) {\n    return _ref5.apply(this, arguments);\n  };\n}();\nexport var getAgentHistory =\n/*#__PURE__*/\nfunction () {\n  var _ref6 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee6(id, date) {\n    var page,\n        size,\n        domainId,\n        response,\n        _args6 = arguments;\n    return regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            page = _args6.length > 2 && _args6[2] !== undefined ? _args6[2] : 0;\n            size = _args6.length > 3 && _args6[3] !== undefined ? _args6[3] : 10;\n            domainId = store.state.userinfo.domainId || undefined;\n            _context6.prev = 3;\n            _context6.next = 6;\n            return agentService.searchAgentStateHistory(id, page, size, date, Date.now(), domainId);\n\n          case 6:\n            response = _context6.sent;\n            return _context6.abrupt(\"return\", response.items ? response.items : []);\n\n          case 10:\n            _context6.prev = 10;\n            _context6.t0 = _context6[\"catch\"](3);\n            throw _context6.t0;\n\n          case 13:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6, null, [[3, 10]]);\n  }));\n\n  return function getAgentHistory(_x6, _x7) {\n    return _ref6.apply(this, arguments);\n  };\n}();\nexport var getAgentTeamsList =\n/*#__PURE__*/\nfunction () {\n  var _ref7 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee7(id) {\n    var page,\n        size,\n        domainId,\n        response,\n        _args7 = arguments;\n    return regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            page = _args7.length > 1 && _args7[1] !== undefined ? _args7[1] : 0;\n            size = _args7.length > 2 && _args7[2] !== undefined ? _args7[2] : 10;\n            domainId = store.state.userinfo.domainId || undefined;\n            _context7.prev = 3;\n            _context7.next = 6;\n            return agentService.searchAgentInTeam(id, page, size, domainId);\n\n          case 6:\n            response = _context7.sent;\n            return _context7.abrupt(\"return\", response.items ? response.items : []);\n\n          case 10:\n            _context7.prev = 10;\n            _context7.t0 = _context7[\"catch\"](3);\n            throw _context7.t0;\n\n          case 13:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7, null, [[3, 10]]);\n  }));\n\n  return function getAgentTeamsList(_x8) {\n    return _ref7.apply(this, arguments);\n  };\n}();\nexport var getAgentQueuesList =\n/*#__PURE__*/\nfunction () {\n  var _ref8 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee8(id) {\n    var page,\n        size,\n        domainId,\n        response,\n        _args8 = arguments;\n    return regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            page = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : 0;\n            size = _args8.length > 2 && _args8[2] !== undefined ? _args8[2] : 10;\n            domainId = store.state.userinfo.domainId || undefined;\n            _context8.prev = 3;\n            _context8.next = 6;\n            return agentService.searchAgentInQueue(id, page, size, domainId);\n\n          case 6:\n            response = _context8.sent;\n            return _context8.abrupt(\"return\", response.items ? response.items : []);\n\n          case 10:\n            _context8.prev = 10;\n            _context8.t0 = _context8[\"catch\"](3);\n            throw _context8.t0;\n\n          case 13:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8, null, [[3, 10]]);\n  }));\n\n  return function getAgentQueuesList(_x9) {\n    return _ref8.apply(this, arguments);\n  };\n}();\nexport var getAgentPermissions =\n/*#__PURE__*/\nfunction () {\n  var _ref9 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee9(id) {\n    var page,\n        size,\n        search,\n        url,\n        response,\n        _args9 = arguments;\n    return regeneratorRuntime.wrap(function _callee9$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            page = _args9.length > 1 && _args9[1] !== undefined ? _args9[1] : 0;\n            size = _args9.length > 2 && _args9[2] !== undefined ? _args9[2] : 10;\n            search = _args9.length > 3 ? _args9[3] : undefined;\n            // let url = BASE_URL + `?page=${page}size=${size}`;\n            url = BASE_URL + '/' + id + '/acl' + \"?size=\".concat(size);\n            if (search) url += \"&name=\".concat(search, \"*\");\n            _context9.prev = 5;\n            _context9.next = 8;\n            return instance.get(url);\n\n          case 8:\n            response = _context9.sent;\n            return _context9.abrupt(\"return\", coerceObjectPermissionsResponse(response));\n\n          case 12:\n            _context9.prev = 12;\n            _context9.t0 = _context9[\"catch\"](5);\n            throw _context9.t0;\n\n          case 15:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, _callee9, null, [[5, 12]]);\n  }));\n\n  return function getAgentPermissions(_x10) {\n    return _ref9.apply(this, arguments);\n  };\n}();\nexport var patchAgentPermissions =\n/*#__PURE__*/\nfunction () {\n  var _ref10 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee10(id, item) {\n    var url;\n    return regeneratorRuntime.wrap(function _callee10$(_context10) {\n      while (1) {\n        switch (_context10.prev = _context10.next) {\n          case 0:\n            url = BASE_URL + '/' + id + '/acl';\n            _context10.prev = 1;\n            _context10.next = 4;\n            return instance.patch(url, {\n              changes: item\n            });\n\n          case 4:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context10.next = 10;\n            break;\n\n          case 7:\n            _context10.prev = 7;\n            _context10.t0 = _context10[\"catch\"](1);\n            throw _context10.t0;\n\n          case 10:\n          case \"end\":\n            return _context10.stop();\n        }\n      }\n    }, _callee10, null, [[1, 7]]);\n  }));\n\n  return function patchAgentPermissions(_x11, _x12) {\n    return _ref10.apply(this, arguments);\n  };\n}();",{"version":3,"sources":["/home/dev/work/client-auth/src/api/contact-center/agents/agents.js"],"names":["instance","configuration","AgentServiceApiFactory","eventBus","sanitizer","coerceObjectPermissionsResponse","store","deepCopy","agentService","BASE_URL","fieldsToSend","getAgentsList","page","size","search","domainId","state","userinfo","undefined","defaultObject","_isSelected","slice","searchAgent","response","items","map","item","getAgent","id","_dirty","readAgent","addAgent","itemCopy","createAgent","$emit","updateAgent","deleteAgent","getAgentHistory","date","searchAgentStateHistory","Date","now","getAgentTeamsList","searchAgentInTeam","getAgentQueuesList","searchAgentInQueue","getAgentPermissions","url","get","patchAgentPermissions","patch","changes"],"mappings":"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","sourcesContent":["import instance from '../../instance';\nimport configuration from '../../openAPIConfig';\nimport {AgentServiceApiFactory} from 'webitel-sdk';\nimport eventBus from \"../../../utils/eventBus\";\nimport sanitizer from \"../../utils/sanitizer\";\nimport {coerceObjectPermissionsResponse} from \"../../permissions/objects/objects\";\nimport store from \"../../../store/store\";\nimport deepCopy from \"deep-copy\";\n\nconst agentService = new AgentServiceApiFactory\n(configuration, '', instance);\n\nconst BASE_URL = '/call_center/agents';\nconst fieldsToSend = ['domainId', 'user', 'description'];\n\nexport const getAgentsList = async (page = 0, size = 10, search) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    const defaultObject = {\n        _isSelected: false,\n    };\n    if (search && search.slice(-1) !== '*') search += '*';\n\n    try {\n        const response = await agentService.searchAgent(page, size, search, domainId);\n        if (response.items) {\n            return response.items.map(item => {\n                return {...defaultObject, ...item};\n            });\n        }\n        return []\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const getAgent = async (id) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    const defaultObject = {\n        _dirty: false\n    };\n    try {\n        const response = await agentService.readAgent(id, domainId);\n        return {...defaultObject, ...response};\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const addAgent = async (item) => {\n    let itemCopy = deepCopy(item);\n    itemCopy.domainId = store.state.userinfo.domainId || undefined;\n    sanitizer(itemCopy, fieldsToSend);\n    try {\n        const response = await agentService.createAgent(itemCopy);\n        eventBus.$emit('notificationInfo', 'Sucessfully added');\n        return response.id;\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const updateAgent = async (id, item) => {\n    let itemCopy = deepCopy(item);\n    itemCopy.domainId = store.state.userinfo.domainId || undefined;\n    sanitizer(itemCopy, fieldsToSend);\n    try {\n        await agentService.updateAgent(id, itemCopy);\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const deleteAgent = async (id) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    try {\n        await agentService.deleteAgent(id, domainId);\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const getAgentHistory = async (id, date, page = 0, size = 10) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    try {\n        const response = await agentService.searchAgentStateHistory(id, page, size, date, Date.now(), domainId);\n        return response.items ? response.items : [];\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const getAgentTeamsList = async (id, page = 0, size = 10) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    try {\n        const response = await agentService.searchAgentInTeam(id, page, size, domainId);\n        return response.items ? response.items : [];\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const getAgentQueuesList = async (id, page = 0, size = 10) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    try {\n        const response = await agentService.searchAgentInQueue(id, page, size, domainId);\n        return response.items ? response.items : [];\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const getAgentPermissions = async (id, page = 0, size = 10, search) => {\n    // let url = BASE_URL + `?page=${page}size=${size}`;\n    let url = BASE_URL + '/' + id + '/acl' + `?size=${size}`;\n    if (search) url += `&name=${search}*`;\n    try {\n        const response = await instance.get(url);\n        return coerceObjectPermissionsResponse(response);\n    } catch (error) {\n        throw error;\n    }\n};\n\nexport const patchAgentPermissions = async (id, item) => {\n    const url = BASE_URL + '/' + id + '/acl';\n\n    try {\n        await instance.patch(url, {changes: item});\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (error) {\n        throw error;\n    }\n};"]}]}