{"remainingRequest":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js!/home/dev/work/client-auth/src/api/contact-center/resources/resources.js","dependencies":[{"path":"/home/dev/work/client-auth/src/api/contact-center/resources/resources.js","mtime":1580822517543},{"path":"/home/dev/work/client-auth/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.function.name\";\nimport _defineProperty from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport instance from \"../../instance\";\nimport configuration from \"../../openAPIConfig\";\nimport sanitizer from \"../../utils/sanitizer\";\nimport { OutboundResourceServiceApiFactory } from 'webitel-sdk';\nimport eventBus from \"../../../utils/eventBus\";\nimport { coerceObjectPermissionsResponse } from \"../../permissions/objects/objects\";\nimport store from \"../../../store/store\";\nimport deepCopy from \"deep-copy\";\nvar resService = new OutboundResourceServiceApiFactory(configuration, '', instance);\nvar BASE_URL = '/call_center/resources';\nvar fieldsToSend = ['domainId', 'limit', 'enabled', 'rps', 'reserve', 'maxSuccessivelyErrors', 'name', 'errorIds', 'display', 'resourceId', 'gateway'];\nexport var getResourceList =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee(page) {\n    var size,\n        search,\n        domainId,\n        defaultObject,\n        response,\n        _args = arguments;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            size = _args.length > 1 && _args[1] !== undefined ? _args[1] : 10;\n            search = _args.length > 2 ? _args[2] : undefined;\n            domainId = store.state.userinfo.domainId || undefined;\n            defaultObject = {\n              _isSelected: false,\n              name: '',\n              gateway: null,\n              enabled: false,\n              reserve: false,\n              id: 0\n            };\n            if (search && search.slice(-1) !== '*') search += '*';\n            _context.prev = 5;\n            _context.next = 8;\n            return resService.searchOutboundResource(page, size, search, domainId);\n\n          case 8:\n            response = _context.sent;\n\n            if (!response.items) {\n              _context.next = 11;\n              break;\n            }\n\n            return _context.abrupt(\"return\", response.items.map(function (item) {\n              return _objectSpread({}, defaultObject, {}, item);\n            }));\n\n          case 11:\n            return _context.abrupt(\"return\", []);\n\n          case 14:\n            _context.prev = 14;\n            _context.t0 = _context[\"catch\"](5);\n            throw _context.t0;\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[5, 14]]);\n  }));\n\n  return function getResourceList(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var getResource =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee2(id) {\n    var domainId, defaultObject, response;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            domainId = store.state.userinfo.domainId || undefined;\n            defaultObject = {\n              name: '',\n              gateway: {},\n              cps: 0,\n              limit: 0,\n              description: '',\n              maxErrors: 0,\n              errorIds: [],\n              id: 0,\n              _dirty: false\n            };\n            _context2.prev = 2;\n            _context2.next = 5;\n            return resService.readOutboundResource(id, domainId);\n\n          case 5:\n            response = _context2.sent;\n            response.maxErrors = response.maxSuccessivelyErrors;\n            response.cps = response.rps;\n            response.errorIds = response.errorIds.map(function (item) {\n              return {\n                name: item\n              };\n            });\n            return _context2.abrupt(\"return\", _objectSpread({}, defaultObject, {}, response));\n\n          case 12:\n            _context2.prev = 12;\n            _context2.t0 = _context2[\"catch\"](2);\n            throw _context2.t0;\n\n          case 15:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[2, 12]]);\n  }));\n\n  return function getResource(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var addResource =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee3(item) {\n    var itemCopy, response;\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            itemCopy.domainId = store.state.userinfo.domainId || undefined;\n            itemCopy.errorIds = itemCopy.errorIds.map(function (item) {\n              return item.name || item.text;\n            });\n            itemCopy.maxSuccessivelyErrors = item.maxErrors;\n            itemCopy.rps = item.cps;\n            sanitizer(itemCopy, fieldsToSend);\n            _context3.prev = 6;\n            _context3.next = 9;\n            return resService.createOutboundResource(itemCopy);\n\n          case 9:\n            response = _context3.sent;\n            eventBus.$emit('notificationInfo', 'Sucessfully added');\n            return _context3.abrupt(\"return\", response.id);\n\n          case 14:\n            _context3.prev = 14;\n            _context3.t0 = _context3[\"catch\"](6);\n            throw _context3.t0;\n\n          case 17:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[6, 14]]);\n  }));\n\n  return function addResource(_x3) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var updateResource =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee4(id, item) {\n    var itemCopy;\n    return regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            itemCopy.domainId = store.state.userinfo.domainId || undefined;\n            itemCopy.errorIds = itemCopy.errorIds.map(function (item) {\n              return item.name || item.text;\n            });\n            itemCopy.maxSuccessivelyErrors = item.maxErrors;\n            itemCopy.rps = item.cps;\n            sanitizer(itemCopy, fieldsToSend);\n            _context4.prev = 6;\n            _context4.next = 9;\n            return resService.updateOutboundResource(id, itemCopy);\n\n          case 9:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context4.next = 15;\n            break;\n\n          case 12:\n            _context4.prev = 12;\n            _context4.t0 = _context4[\"catch\"](6);\n            throw _context4.t0;\n\n          case 15:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[6, 12]]);\n  }));\n\n  return function updateResource(_x4, _x5) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var patchResource =\n/*#__PURE__*/\nfunction () {\n  var _ref5 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee5(id, item) {\n    var itemCopy;\n    return regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            itemCopy.domainId = store.state.userinfo.domainId || undefined;\n            _context5.prev = 2;\n            _context5.next = 5;\n            return resService.patchOutboundResource(id, itemCopy);\n\n          case 5:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context5.next = 11;\n            break;\n\n          case 8:\n            _context5.prev = 8;\n            _context5.t0 = _context5[\"catch\"](2);\n            throw _context5.t0;\n\n          case 11:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, null, [[2, 8]]);\n  }));\n\n  return function patchResource(_x6, _x7) {\n    return _ref5.apply(this, arguments);\n  };\n}();\nexport var deleteResource =\n/*#__PURE__*/\nfunction () {\n  var _ref6 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee6(id) {\n    var domainId;\n    return regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            domainId = store.state.userinfo.domainId || undefined;\n            _context6.prev = 1;\n            _context6.next = 4;\n            return resService.deleteOutboundResource(id, domainId);\n\n          case 4:\n            _context6.next = 9;\n            break;\n\n          case 6:\n            _context6.prev = 6;\n            _context6.t0 = _context6[\"catch\"](1);\n            throw _context6.t0;\n\n          case 9:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6, null, [[1, 6]]);\n  }));\n\n  return function deleteResource(_x8) {\n    return _ref6.apply(this, arguments);\n  };\n}();\nexport var getResPermissions =\n/*#__PURE__*/\nfunction () {\n  var _ref7 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee7(id) {\n    var page,\n        size,\n        search,\n        url,\n        response,\n        _args7 = arguments;\n    return regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            page = _args7.length > 1 && _args7[1] !== undefined ? _args7[1] : 0;\n            size = _args7.length > 2 && _args7[2] !== undefined ? _args7[2] : 10;\n            search = _args7.length > 3 ? _args7[3] : undefined;\n            // let url = BASE_URL + `?page=${page}size=${size}`;\n            url = BASE_URL + '/' + id + '/acl' + \"?size=\".concat(size);\n            if (search) url += \"&name=\".concat(search, \"*\");\n            _context7.prev = 5;\n            _context7.next = 8;\n            return instance.get(url);\n\n          case 8:\n            response = _context7.sent;\n            return _context7.abrupt(\"return\", coerceObjectPermissionsResponse(response));\n\n          case 12:\n            _context7.prev = 12;\n            _context7.t0 = _context7[\"catch\"](5);\n            throw _context7.t0;\n\n          case 15:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7, null, [[5, 12]]);\n  }));\n\n  return function getResPermissions(_x9) {\n    return _ref7.apply(this, arguments);\n  };\n}();\nexport var patchResPermissions =\n/*#__PURE__*/\nfunction () {\n  var _ref8 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee8(id, item) {\n    var url;\n    return regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            url = BASE_URL + '/' + id + '/acl';\n            _context8.prev = 1;\n            _context8.next = 4;\n            return instance.patch(url, {\n              changes: item\n            });\n\n          case 4:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context8.next = 10;\n            break;\n\n          case 7:\n            _context8.prev = 7;\n            _context8.t0 = _context8[\"catch\"](1);\n            throw _context8.t0;\n\n          case 10:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8, null, [[1, 7]]);\n  }));\n\n  return function patchResPermissions(_x10, _x11) {\n    return _ref8.apply(this, arguments);\n  };\n}();",{"version":3,"sources":["/home/dev/work/client-auth/src/api/contact-center/resources/resources.js"],"names":["instance","configuration","sanitizer","OutboundResourceServiceApiFactory","eventBus","coerceObjectPermissionsResponse","store","deepCopy","resService","BASE_URL","fieldsToSend","getResourceList","page","size","search","domainId","state","userinfo","undefined","defaultObject","_isSelected","name","gateway","enabled","reserve","id","slice","searchOutboundResource","response","items","map","item","getResource","cps","limit","description","maxErrors","errorIds","_dirty","readOutboundResource","maxSuccessivelyErrors","rps","addResource","itemCopy","text","createOutboundResource","$emit","updateResource","updateOutboundResource","patchResource","patchOutboundResource","deleteResource","deleteOutboundResource","getResPermissions","url","get","patchResPermissions","patch","changes"],"mappings":"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","sourcesContent":["import instance from '../../instance';\nimport configuration from '../../openAPIConfig';\nimport sanitizer from '../../utils/sanitizer';\nimport {OutboundResourceServiceApiFactory} from 'webitel-sdk';\nimport eventBus from \"../../../utils/eventBus\";\nimport {coerceObjectPermissionsResponse} from \"../../permissions/objects/objects\";\nimport store from \"../../../store/store\";\nimport deepCopy from \"deep-copy\";\n\nconst resService = new OutboundResourceServiceApiFactory\n(configuration, '', instance);\n\nconst BASE_URL = '/call_center/resources';\nconst fieldsToSend = ['domainId', 'limit', 'enabled',\n    'rps', 'reserve', 'maxSuccessivelyErrors',\n    'name', 'errorIds', 'display', 'resourceId', 'gateway'];\n\nexport const getResourceList = async (page, size = 10, search) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    const defaultObject = {\n        _isSelected: false,\n        name: '',\n        gateway: null,\n        enabled: false,\n        reserve: false,\n        id: 0,\n    };\n    if (search && search.slice(-1) !== '*') search += '*';\n\n    try {\n        const response = await resService.searchOutboundResource(page, size, search, domainId);\n        if (response.items) {\n            return response.items.map(item => {\n                return {...defaultObject, ...item};\n            });\n        }\n        return [];\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const getResource = async (id) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    const defaultObject = {\n        name: '',\n        gateway: {},\n        cps: 0,\n        limit: 0,\n        description: '',\n        maxErrors: 0,\n        errorIds: [],\n        id: 0,\n        _dirty: false,\n    };\n\n    try {\n        const response = await resService.readOutboundResource(id, domainId);\n        response.maxErrors = response.maxSuccessivelyErrors;\n        response.cps = response.rps;\n        response.errorIds = response.errorIds.map(item => {\n            return {name: item}\n        });\n        return {...defaultObject, ...response};\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const addResource = async (item) => {\n    let itemCopy = deepCopy(item);\n    itemCopy.domainId = store.state.userinfo.domainId || undefined;\n    itemCopy.errorIds = itemCopy.errorIds.map(item => item.name || item.text);\n    itemCopy.maxSuccessivelyErrors = item.maxErrors;\n    itemCopy.rps = item.cps;\n    sanitizer(itemCopy, fieldsToSend);\n    try {\n        const response = await resService.createOutboundResource(itemCopy);\n        eventBus.$emit('notificationInfo', 'Sucessfully added');\n        return response.id;\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const updateResource = async (id, item) => {\n    let itemCopy = deepCopy(item);\n    itemCopy.domainId = store.state.userinfo.domainId || undefined;\n    itemCopy.errorIds = itemCopy.errorIds.map(item => item.name || item.text);\n    itemCopy.maxSuccessivelyErrors = item.maxErrors;\n    itemCopy.rps = item.cps;\n    sanitizer(itemCopy, fieldsToSend);\n    try {\n        await resService.updateOutboundResource(id, itemCopy);\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const patchResource = async (id, item) => {\n    let itemCopy = deepCopy(item);\n    itemCopy.domainId = store.state.userinfo.domainId || undefined;\n    try {\n        await resService.patchOutboundResource(id, itemCopy);\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const deleteResource = async (id) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    try {\n        await resService.deleteOutboundResource(id, domainId);\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const getResPermissions = async (id, page = 0, size = 10, search) => {\n    // let url = BASE_URL + `?page=${page}size=${size}`;\n    let url = BASE_URL + '/' + id + '/acl' + `?size=${size}`;\n    if (search) url += `&name=${search}*`;\n    try {\n        const response = await instance.get(url);\n        return coerceObjectPermissionsResponse(response);\n    } catch (error) {\n        throw error;\n    }\n};\n\nexport const patchResPermissions = async (id, item) => {\n    const url = BASE_URL + '/' + id + '/acl';\n\n    try {\n        await instance.patch(url, {changes: item});\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (error) {\n        throw error;\n    }\n};"]}]}