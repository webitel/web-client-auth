{"remainingRequest":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js!/home/dev/work/client-auth/src/store/modules/permissions/objects/objects.js","dependencies":[{"path":"/home/dev/work/client-auth/src/store/modules/permissions/objects/objects.js","mtime":1580207989292},{"path":"/home/dev/work/client-auth/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.search\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { getObjectList, getObjectPermissions, patchObjectPermissions, updateObject } from \"../../../../api/permissions/objects/objects\";\n\nvar defaultState = function defaultState() {\n  return {\n    itemId: 0,\n    itemSize: '10',\n    itemSearch: '',\n    itemPage: 0,\n    isItemNextPage: true,\n    itemPermissionsDataList: []\n  };\n};\n\nvar state = _objectSpread({\n  dataList: [],\n  search: ''\n}, defaultState());\n\nvar getters = {};\nvar actions = {\n  SET_ITEM_ID: function SET_ITEM_ID(context, id) {\n    if (id !== 'new') context.commit('SET_ITEM_ID', id);\n  },\n  LOAD_DATA_LIST: function () {\n    var _LOAD_DATA_LIST = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee(context) {\n      var response;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return getObjectList(state.search);\n\n            case 2:\n              response = _context.sent;\n              context.dispatch('RESET_ITEM_STATE');\n              context.commit('SET_DATA_LIST', response);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function LOAD_DATA_LIST(_x) {\n      return _LOAD_DATA_LIST.apply(this, arguments);\n    }\n\n    return LOAD_DATA_LIST;\n  }(),\n  SET_SEARCH: function SET_SEARCH(context, search) {\n    context.commit('SET_SEARCH', search);\n  },\n  TOGGLE_ITEM_PROPERTY: function () {\n    var _TOGGLE_ITEM_PROPERTY = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee2(context, _ref) {\n      var prop, index;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              prop = _ref.prop, index = _ref.index;\n              _context2.next = 3;\n              return context.commit('TOGGLE_ITEM_PROPERTY', {\n                prop: prop,\n                index: index\n              });\n\n            case 3:\n              _context2.prev = 3;\n              _context2.next = 6;\n              return updateObject(state.dataList[index].id, state.dataList[index]);\n\n            case 6:\n              _context2.next = 11;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](3);\n              context.dispatch('LOAD_DATA_LIST');\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[3, 8]]);\n    }));\n\n    function TOGGLE_ITEM_PROPERTY(_x2, _x3) {\n      return _TOGGLE_ITEM_PROPERTY.apply(this, arguments);\n    }\n\n    return TOGGLE_ITEM_PROPERTY;\n  }(),\n  SET_ITEM_PERMISSIONS_SIZE: function SET_ITEM_PERMISSIONS_SIZE(context, size) {\n    context.commit('SET_ITEM_PERMISSIONS_SIZE', size);\n  },\n  SET_ITEM_PERMISSIONS_SEARCH: function SET_ITEM_PERMISSIONS_SEARCH(context, search) {\n    context.commit('SET_ITEM_PERMISSIONS_SEARCH', search);\n  },\n  NEXT_ITEM_PERMISSIONS_PAGE: function NEXT_ITEM_PERMISSIONS_PAGE(context) {\n    if (state.isNextPage) {\n      context.commit('INCREMENT_ITEM_PERMISSIONS_PAGE');\n      context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_LIST');\n    }\n  },\n  PREV_ITEM_PERMISSIONS_PAGE: function PREV_ITEM_PERMISSIONS_PAGE(context) {\n    if (state.page) {\n      context.commit('DECREMENT_ITEM_PERMISSIONS_PAGE');\n      context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_LIST');\n    }\n  },\n  LOAD_ITEM_PERMISSIONS_DATA_lIST: function () {\n    var _LOAD_ITEM_PERMISSIONS_DATA_lIST = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee3(context) {\n      var item;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!state.itemId) {\n                _context3.next = 5;\n                break;\n              }\n\n              _context3.next = 3;\n              return getObjectPermissions(state.itemId, state.itemPage, state.itemSize, state.itemSearch);\n\n            case 3:\n              item = _context3.sent;\n              context.commit('SET_ITEM_PERMISSIONS_DATA_lIST', item);\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    function LOAD_ITEM_PERMISSIONS_DATA_lIST(_x4) {\n      return _LOAD_ITEM_PERMISSIONS_DATA_lIST.apply(this, arguments);\n    }\n\n    return LOAD_ITEM_PERMISSIONS_DATA_lIST;\n  }(),\n  PATCH_ITEM_PERMISSIONS: function () {\n    var _PATCH_ITEM_PERMISSIONS = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee4(context, _ref2) {\n      var prop, index, readState, item;\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              prop = _ref2.prop, index = _ref2.index;\n              readState = state.itemPermissionsDataList[index].access.r;\n              _context4.next = 4;\n              return context.commit('PATCH_ITEM_PERMISSIONS', {\n                prop: prop,\n                index: index\n              });\n\n            case 4:\n              item = [{\n                grantee_id: state.itemPermissionsDataList[index].grantee.id,\n                access: prop\n              }];\n              if (!readState) item[0].access += 'r';\n              _context4.prev = 6;\n              _context4.next = 9;\n              return patchObjectPermissions(state.itemId, item);\n\n            case 9:\n              _context4.next = 14;\n              break;\n\n            case 11:\n              _context4.prev = 11;\n              _context4.t0 = _context4[\"catch\"](6);\n              context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_lIST');\n\n            case 14:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[6, 11]]);\n    }));\n\n    function PATCH_ITEM_PERMISSIONS(_x5, _x6) {\n      return _PATCH_ITEM_PERMISSIONS.apply(this, arguments);\n    }\n\n    return PATCH_ITEM_PERMISSIONS;\n  }(),\n  ADD_ITEM_ROLE: function () {\n    var _ADD_ITEM_ROLE = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee5(context, role) {\n      var item;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              item = [{\n                grantee_id: role.id,\n                access: 'r'\n              }];\n              _context5.prev = 1;\n              _context5.next = 4;\n              return patchObjectPermissions(state.itemId, item);\n\n            case 4:\n              context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_lIST');\n              _context5.next = 10;\n              break;\n\n            case 7:\n              _context5.prev = 7;\n              _context5.t0 = _context5[\"catch\"](1);\n              context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_lIST');\n\n            case 10:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[1, 7]]);\n    }));\n\n    function ADD_ITEM_ROLE(_x7, _x8) {\n      return _ADD_ITEM_ROLE.apply(this, arguments);\n    }\n\n    return ADD_ITEM_ROLE;\n  }(),\n  RESET_ITEM_STATE: function () {\n    var _RESET_ITEM_STATE = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee6(context) {\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              context.commit('RESET_ITEM_STATE');\n\n            case 1:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    function RESET_ITEM_STATE(_x9) {\n      return _RESET_ITEM_STATE.apply(this, arguments);\n    }\n\n    return RESET_ITEM_STATE;\n  }()\n};\nvar mutations = {\n  SET_ITEM_ID: function SET_ITEM_ID(state, id) {\n    state.itemId = id;\n  },\n  SET_DATA_LIST: function SET_DATA_LIST(state, list) {\n    state.dataList = list;\n  },\n  SET_SEARCH: function SET_SEARCH(state, search) {\n    state.search = search;\n  },\n  TOGGLE_ITEM_PROPERTY: function TOGGLE_ITEM_PROPERTY(state, _ref3) {\n    var prop = _ref3.prop,\n        index = _ref3.index;\n    state.dataList[index][prop] = !state.dataList[index][prop];\n  },\n  SET_SIZE: function SET_SIZE(context, size) {\n    state.itemSize = size;\n  },\n  SET_ITEM_PERMISSIONS_SEARCH: function SET_ITEM_PERMISSIONS_SEARCH(context, search) {\n    state.itemSearch = search;\n  },\n  INCREMENT_ITEM_PERMISSIONS_PAGE: function INCREMENT_ITEM_PERMISSIONS_PAGE(state) {\n    state.itemPage++;\n  },\n  DECREMENT_ITEM_PERMISSIONS_PAGE: function DECREMENT_ITEM_PERMISSIONS_PAGE(state) {\n    state.itemPage--;\n  },\n  SET_ITEM_PERMISSIONS_DATA_lIST: function SET_ITEM_PERMISSIONS_DATA_lIST(state, item) {\n    state.itemPermissionsDataList = item;\n  },\n  PATCH_ITEM_PERMISSIONS: function PATCH_ITEM_PERMISSIONS(state, _ref4) {\n    var prop = _ref4.prop,\n        index = _ref4.index;\n\n    // if 'read' checkbox switches to false, make all operations false\n    if (prop === 'r' && state.itemPermissionsDataList[index].access.r) {\n      Object.keys(state.itemPermissionsDataList[index].access).map(function (item) {\n        state.itemPermissionsDataList[index].access[item] = false;\n      });\n      return; // else if another operation switches to true with unactive 'read', activate 'read' too\n    } else if (!state.itemPermissionsDataList[index].access.r && prop !== 'r') {\n      state.itemPermissionsDataList[index].access.r = true;\n    }\n\n    state.itemPermissionsDataList[index].access[prop] = !state.itemPermissionsDataList[index].access[prop];\n  },\n  RESET_ITEM_STATE: function RESET_ITEM_STATE(state) {\n    Object.assign(state, defaultState());\n  }\n};\nexport default {\n  namespaced: true,\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};",{"version":3,"sources":["/home/dev/work/client-auth/src/store/modules/permissions/objects/objects.js"],"names":["getObjectList","getObjectPermissions","patchObjectPermissions","updateObject","defaultState","itemId","itemSize","itemSearch","itemPage","isItemNextPage","itemPermissionsDataList","state","dataList","search","getters","actions","SET_ITEM_ID","context","id","commit","LOAD_DATA_LIST","response","dispatch","SET_SEARCH","TOGGLE_ITEM_PROPERTY","prop","index","SET_ITEM_PERMISSIONS_SIZE","size","SET_ITEM_PERMISSIONS_SEARCH","NEXT_ITEM_PERMISSIONS_PAGE","isNextPage","PREV_ITEM_PERMISSIONS_PAGE","page","LOAD_ITEM_PERMISSIONS_DATA_lIST","item","PATCH_ITEM_PERMISSIONS","readState","access","r","grantee_id","grantee","ADD_ITEM_ROLE","role","RESET_ITEM_STATE","mutations","SET_DATA_LIST","list","SET_SIZE","INCREMENT_ITEM_PERMISSIONS_PAGE","DECREMENT_ITEM_PERMISSIONS_PAGE","SET_ITEM_PERMISSIONS_DATA_lIST","Object","keys","map","assign","namespaced"],"mappings":"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","sourcesContent":["import {\n    getObjectList,\n    getObjectPermissions,\n    patchObjectPermissions,\n    updateObject\n} from \"../../../../api/permissions/objects/objects\";\n\nconst defaultState = () => {\n    return {\n        itemId: 0,\n        itemSize: '10',\n        itemSearch: '',\n        itemPage: 0,\n        isItemNextPage: true,\n        itemPermissionsDataList: [],\n    };\n};\n\nconst state = {\n    dataList: [],\n    search: '',\n    ...defaultState()\n};\n\nconst getters = {};\n\nconst actions = {\n    SET_ITEM_ID: (context, id) => {\n        if (id !== 'new') context.commit('SET_ITEM_ID', id);\n    },\n\n    LOAD_DATA_LIST: async (context) => {\n        const response = await getObjectList(state.search);\n        context.dispatch('RESET_ITEM_STATE');\n        context.commit('SET_DATA_LIST', response);\n    },\n\n    SET_SEARCH: (context, search) => {\n        context.commit('SET_SEARCH', search);\n    },\n\n    TOGGLE_ITEM_PROPERTY: async (context, {prop, index}) => {\n        await context.commit('TOGGLE_ITEM_PROPERTY', {prop, index});\n        try {\n            await updateObject(state.dataList[index].id, state.dataList[index]);\n        } catch {\n            context.dispatch('LOAD_DATA_LIST');\n        }\n    },\n\n    SET_ITEM_PERMISSIONS_SIZE: (context, size) => {\n        context.commit('SET_ITEM_PERMISSIONS_SIZE', size);\n    },\n\n    SET_ITEM_PERMISSIONS_SEARCH: (context, search) => {\n        context.commit('SET_ITEM_PERMISSIONS_SEARCH', search);\n    },\n\n    NEXT_ITEM_PERMISSIONS_PAGE: (context) => {\n        if(state.isNextPage) {\n            context.commit('INCREMENT_ITEM_PERMISSIONS_PAGE');\n            context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_LIST');\n        }\n    },\n\n    PREV_ITEM_PERMISSIONS_PAGE: (context) => {\n        if(state.page) {\n            context.commit('DECREMENT_ITEM_PERMISSIONS_PAGE');\n            context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_LIST');\n        }\n    },\n\n    LOAD_ITEM_PERMISSIONS_DATA_lIST: async (context) => {\n        if (state.itemId) {\n            const item = await getObjectPermissions(state.itemId, state.itemPage, state.itemSize, state.itemSearch);\n            context.commit('SET_ITEM_PERMISSIONS_DATA_lIST', item);\n        }\n    },\n\n    PATCH_ITEM_PERMISSIONS: async (context, {prop, index}) => {\n        const readState = state.itemPermissionsDataList[index].access.r;\n        await context.commit('PATCH_ITEM_PERMISSIONS', {prop, index});\n        let item = [{\n            grantee_id: state.itemPermissionsDataList[index].grantee.id,\n            access: prop\n        }];\n        if (!readState) item[0].access += 'r';\n        try {\n            await patchObjectPermissions(state.itemId, item);\n        } catch {\n            context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_lIST');\n        }\n    },\n\n    ADD_ITEM_ROLE: async (context, role) => {\n        const item = [{\n            grantee_id: role.id,\n            access: 'r'\n        }];\n        try {\n            await patchObjectPermissions(state.itemId, item);\n            context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_lIST');\n        } catch {\n            context.dispatch('LOAD_ITEM_PERMISSIONS_DATA_lIST');\n        }\n    },\n\n    RESET_ITEM_STATE: async (context) => {\n        context.commit('RESET_ITEM_STATE');\n    },\n};\n\nconst mutations = {\n    SET_ITEM_ID: (state, id) => {\n        state.itemId = id;\n    },\n\n    SET_DATA_LIST: (state, list) => {\n        state.dataList = list;\n    },\n\n    SET_SEARCH: (state, search) => {\n        state.search = search;\n    },\n\n    TOGGLE_ITEM_PROPERTY: (state, {prop, index}) => {\n        state.dataList[index][prop] = !state.dataList[index][prop];\n    },\n\n    SET_SIZE: (context, size) => {\n        state.itemSize = size;\n    },\n\n    SET_ITEM_PERMISSIONS_SEARCH: (context, search) => {\n        state.itemSearch = search;\n    },\n\n    INCREMENT_ITEM_PERMISSIONS_PAGE: (state) => {\n        state.itemPage++;\n    },\n\n    DECREMENT_ITEM_PERMISSIONS_PAGE: (state) => {\n        state.itemPage--;\n    },\n\n    SET_ITEM_PERMISSIONS_DATA_lIST: (state, item) => {\n        state.itemPermissionsDataList = item;\n    },\n\n    PATCH_ITEM_PERMISSIONS: (state, {prop, index}) => {\n        // if 'read' checkbox switches to false, make all operations false\n        if (prop === 'r' && state.itemPermissionsDataList[index].access.r) {\n            Object.keys(state.itemPermissionsDataList[index].access).map(item => {\n                state.itemPermissionsDataList[index].access[item] = false\n            });\n            return\n            // else if another operation switches to true with unactive 'read', activate 'read' too\n        } else if (!state.itemPermissionsDataList[index].access.r && prop !== 'r') {\n            state.itemPermissionsDataList[index].access.r = true;\n        }\n        state.itemPermissionsDataList[index].access[prop] = !state.itemPermissionsDataList[index].access[prop];\n\n    },\n\n    RESET_ITEM_STATE: (state) => {\n        Object.assign(state, defaultState());\n    },\n};\n\nexport default {\n    namespaced: true,\n    state,\n    getters,\n    actions,\n    mutations,\n};\n"]}]}