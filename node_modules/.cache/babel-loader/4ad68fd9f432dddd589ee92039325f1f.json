{"remainingRequest":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js!/home/dev/work/client-auth/src/api/directory/users/users.js","dependencies":[{"path":"/home/dev/work/client-auth/src/api/directory/users/users.js","mtime":1580811831006},{"path":"/home/dev/work/client-auth/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport instance from \"../../instance\";\nimport sanitizer from \"../../utils/sanitizer\";\nimport eventBus from \"../../../utils/eventBus\";\nimport deepCopy from \"deep-copy\";\nvar BASE_URL = '/users';\nvar fieldsToSend = ['name', 'username', 'password', 'extension', 'status', 'dnd', 'roles', 'license', 'devices', 'profile', 'profile', 'email'];\nexport function getUsersList() {\n  return _getUsersList.apply(this, arguments);\n}\n\nfunction _getUsersList() {\n  _getUsersList = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee5() {\n    var page,\n        size,\n        search,\n        defaultObject,\n        url,\n        response,\n        _args5 = arguments;\n    return regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            page = _args5.length > 0 && _args5[0] !== undefined ? _args5[0] : 0;\n            size = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : 100;\n            search = _args5.length > 2 ? _args5[2] : undefined;\n            defaultObject = {\n              // default object prototype, to merge response with it to get all fields\n              _isSelected: false,\n              name: 'Username undefined',\n              username: 'Username undefined',\n              status: 'Status is undefined',\n              state: true,\n              dnd: false,\n              id: 0\n            }; // let url = BASE_URL + `?page=${page}size=${size}`;\n\n            url = BASE_URL + \"?size=\".concat(size);\n            if (search) url += \"&name=\".concat(search, \"*\");\n            _context5.prev = 6;\n            _context5.next = 9;\n            return instance.get(url);\n\n          case 9:\n            response = _context5.sent;\n\n            if (!response.users) {\n              _context5.next = 12;\n              break;\n            }\n\n            return _context5.abrupt(\"return\", response.users.map(function (item) {\n              return _objectSpread({}, defaultObject, {}, item);\n            }));\n\n          case 12:\n            return _context5.abrupt(\"return\", []);\n\n          case 15:\n            _context5.prev = 15;\n            _context5.t0 = _context5[\"catch\"](6);\n            throw _context5.t0;\n\n          case 18:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, null, [[6, 15]]);\n  }));\n  return _getUsersList.apply(this, arguments);\n}\n\nexport function getUser(_x) {\n  return _getUser.apply(this, arguments);\n}\n\nfunction _getUser() {\n  _getUser = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee6(id) {\n    var url, defaultObject, response, user;\n    return regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            url = BASE_URL + '/' + id;\n            defaultObject = {\n              name: '',\n              username: '',\n              password: '',\n              extension: '',\n              roles: [],\n              license: [],\n              devices: [],\n              variables: [{\n                key: '',\n                value: ''\n              }],\n              _dirty: false\n            };\n            _context6.prev = 2;\n            _context6.next = 5;\n            return instance.get(url);\n\n          case 5:\n            response = _context6.sent;\n            user = _objectSpread({}, defaultObject, {}, response.user);\n            if (user.license) user.license.forEach(function (item) {\n              item.name = item.prod;\n            });\n\n            if (user.profile) {\n              user.variables = Object.keys(user.profile).map(function (key) {\n                return {\n                  key: key,\n                  value: user.profile[key]\n                };\n              });\n            } else {\n              user.variables = [{\n                key: '',\n                value: ''\n              }];\n            }\n\n            return _context6.abrupt(\"return\", user);\n\n          case 12:\n            _context6.prev = 12;\n            _context6.t0 = _context6[\"catch\"](2);\n            throw _context6.t0;\n\n          case 15:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6, null, [[2, 12]]);\n  }));\n  return _getUser.apply(this, arguments);\n}\n\nexport var addUser =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee(item) {\n    var itemCopy, response;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            if (itemCopy.roles) itemCopy.roles.forEach(function (item) {\n              return delete item.text;\n            });\n            if (itemCopy.devices) itemCopy.devices.forEach(function (item) {\n              return delete item.text;\n            });\n            if (itemCopy.license) itemCopy.license = itemCopy.license.map(function (item) {\n              return {\n                id: item.id\n              };\n            });\n            itemCopy.profile = {};\n\n            if (itemCopy.variables) {\n              itemCopy.variables.forEach(function (variable) {\n                itemCopy.profile[variable.key] = variable.value;\n              });\n            }\n\n            sanitizer(itemCopy, fieldsToSend);\n            _context.prev = 7;\n            _context.next = 10;\n            return instance.post(BASE_URL, {\n              user: itemCopy\n            });\n\n          case 10:\n            response = _context.sent;\n            eventBus.$emit('notificationInfo', 'Sucessfully added');\n            return _context.abrupt(\"return\", response.user.id);\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](7);\n            throw _context.t0;\n\n          case 18:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[7, 15]]);\n  }));\n\n  return function addUser(_x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var updateUser =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee2(id, item) {\n    var itemCopy, url;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            itemCopy = deepCopy(item);\n            url = BASE_URL + '/' + id;\n            itemCopy.roles.forEach(function (item) {\n              return delete item.text;\n            });\n            itemCopy.devices.forEach(function (item) {\n              return delete item.text;\n            });\n            itemCopy.license = itemCopy.license.map(function (item) {\n              return {\n                id: item.id\n              };\n            });\n            itemCopy.profile = {};\n            itemCopy.variables.forEach(function (variable) {\n              itemCopy.profile[variable.key] = variable.value;\n            });\n            sanitizer(itemCopy, fieldsToSend);\n            _context2.prev = 8;\n            _context2.next = 11;\n            return instance.put(url, {\n              user: itemCopy\n            });\n\n          case 11:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context2.next = 17;\n            break;\n\n          case 14:\n            _context2.prev = 14;\n            _context2.t0 = _context2[\"catch\"](8);\n            throw _context2.t0;\n\n          case 17:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[8, 14]]);\n  }));\n\n  return function updateUser(_x3, _x4) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var patchUser =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee3(id, user) {\n    var url;\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            url = BASE_URL + '/' + id;\n            _context3.prev = 1;\n            _context3.next = 4;\n            return instance.patch(url, {\n              user: user\n            });\n\n          case 4:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context3.next = 10;\n            break;\n\n          case 7:\n            _context3.prev = 7;\n            _context3.t0 = _context3[\"catch\"](1);\n            throw _context3.t0;\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[1, 7]]);\n  }));\n\n  return function patchUser(_x5, _x6) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var deleteUser =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee4(id) {\n    var url;\n    return regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            url = BASE_URL + '/' + id + '?permanent=true';\n            _context4.prev = 1;\n            _context4.next = 4;\n            return instance.delete(url);\n\n          case 4:\n            _context4.next = 9;\n            break;\n\n          case 6:\n            _context4.prev = 6;\n            _context4.t0 = _context4[\"catch\"](1);\n            throw _context4.t0;\n\n          case 9:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[1, 6]]);\n  }));\n\n  return function deleteUser(_x7) {\n    return _ref4.apply(this, arguments);\n  };\n}();",{"version":3,"sources":["/home/dev/work/client-auth/src/api/directory/users/users.js"],"names":["instance","sanitizer","eventBus","deepCopy","BASE_URL","fieldsToSend","getUsersList","page","size","search","defaultObject","_isSelected","name","username","status","state","dnd","id","url","get","response","users","map","item","getUser","password","extension","roles","license","devices","variables","key","value","_dirty","user","forEach","prod","profile","Object","keys","addUser","itemCopy","text","variable","post","$emit","updateUser","put","patchUser","patch","deleteUser","delete"],"mappings":"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","sourcesContent":["import instance from '../../instance';\nimport sanitizer from \"../../utils/sanitizer\";\nimport eventBus from \"../../../utils/eventBus\";\nimport deepCopy from \"deep-copy\";\n\nconst BASE_URL = '/users';\nconst fieldsToSend = ['name', 'username', 'password', 'extension', 'status', 'dnd', 'roles', 'license', 'devices',\n    'profile', 'profile', 'email'];\n\nexport async function getUsersList(page = 0, size = 100, search) {\n    const defaultObject = {  // default object prototype, to merge response with it to get all fields\n        _isSelected: false,\n        name: 'Username undefined',\n        username: 'Username undefined',\n        status: 'Status is undefined',\n        state: true,\n        dnd: false,\n        id: 0\n    };\n\n    // let url = BASE_URL + `?page=${page}size=${size}`;\n    let url = BASE_URL + `?size=${size}`;\n    if (search) url += `&name=${search}*`;\n\n    try {\n        let response = await instance.get(url);\n        if (response.users) {\n            return response.users.map(item => {\n                return {...defaultObject, ...item};\n            });\n        }\n        return [];\n    } catch (error) {\n        throw error;\n    }\n}\n\nexport async function getUser(id) {\n    const url = BASE_URL + '/' + id;\n    const defaultObject = {\n        name: '',\n        username: '',\n        password: '',\n        extension: '',\n        roles: [],\n        license: [],\n        devices: [],\n        variables: [\n            {key: '', value: ''}\n        ],\n        _dirty: false,\n    };\n    try {\n        const response = await instance.get(url);\n        let user = {...defaultObject, ...response.user};\n        if (user.license) user.license.forEach(item => {item.name = item.prod});\n        if (user.profile) {\n            user.variables = Object.keys(user.profile).map(key => {\n                return {\n                    key,\n                    value: user.profile[key],\n                }\n            });\n        } else {\n            user.variables = [{key: '', value: ''}];\n        }\n        return user;\n    } catch (error) {\n        throw error;\n    }\n}\n\nexport const addUser = async (item) => {\n    let itemCopy = deepCopy(item);\n    if (itemCopy.roles) itemCopy.roles.forEach(item => delete item.text);\n    if (itemCopy.devices) itemCopy.devices.forEach(item => delete item.text);\n    if (itemCopy.license) itemCopy.license = itemCopy.license.map(item => {\n        return {id: item.id}\n    });\n    itemCopy.profile = {};\n    if (itemCopy.variables) {\n        itemCopy.variables.forEach(variable => {\n            itemCopy.profile[variable.key] = variable.value;\n        });\n    }\n    sanitizer(itemCopy, fieldsToSend);\n    try {\n        const response = await instance.post(BASE_URL, {user: itemCopy});\n        eventBus.$emit('notificationInfo', 'Sucessfully added');\n        return response.user.id;\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const updateUser = async (id, item) => {\n    let itemCopy = deepCopy(item);\n    const url = BASE_URL + '/' + id;\n    itemCopy.roles.forEach(item => delete item.text);\n    itemCopy.devices.forEach(item => delete item.text);\n    itemCopy.license = itemCopy.license.map(item => {\n        return {id: item.id}\n    });\n    itemCopy.profile = {};\n    itemCopy.variables.forEach(variable => {\n        itemCopy.profile[variable.key] = variable.value;\n    });\n    sanitizer(itemCopy, fieldsToSend);\n    try {\n        await instance.put(url, {user: itemCopy});\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const patchUser = async (id, user) => {\n    const url = BASE_URL + '/' + id;\n    try {\n        await instance.patch(url, {user});\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const deleteUser = async (id) => {\n    const url = BASE_URL + '/' + id + '?permanent=true';\n    try {\n        await instance.delete(url);\n    } catch (err) {\n        throw err;\n    }\n};"]}]}