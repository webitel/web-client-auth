{"remainingRequest":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js!/home/dev/work/client-auth/src/api/permissions/objects/objects.js","dependencies":[{"path":"/home/dev/work/client-auth/src/api/permissions/objects/objects.js","mtime":1580810115765},{"path":"/home/dev/work/client-auth/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es6.function.name\";\nimport _defineProperty from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport instance from \"../../instance\";\nimport eventBus from \"../../../utils/eventBus\";\nvar BASE_URL = '/objects';\nexport var getObjectList =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee(search) {\n    var defaultObject, url, response;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            defaultObject = {\n              // default object prototype, to merge response with it to get all fields\n              class: '',\n              obac: false,\n              rbac: false,\n              id: 0\n            };\n            url = BASE_URL;\n            if (search) url += \"name='\".concat(search, \"*\");\n            _context.prev = 3;\n            _context.next = 6;\n            return instance.get(url);\n\n          case 6:\n            response = _context.sent;\n            return _context.abrupt(\"return\", response.classes.map(function (item) {\n              return _objectSpread({}, defaultObject, {}, item);\n            }));\n\n          case 10:\n            _context.prev = 10;\n            _context.t0 = _context[\"catch\"](3);\n            throw _context.t0;\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[3, 10]]);\n  }));\n\n  return function getObjectList(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var updateObject =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee2(id, item) {\n    var url, updatedItem;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            url = BASE_URL + '/' + id;\n            updatedItem = {\n              class: {\n                obac: item.obac,\n                rbac: item.rbac\n              }\n            };\n            _context2.prev = 2;\n            _context2.next = 5;\n            return instance.put(url, updatedItem);\n\n          case 5:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context2.next = 11;\n            break;\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](2);\n            throw _context2.t0;\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[2, 8]]);\n  }));\n\n  return function updateObject(_x2, _x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var getObject =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee3(id) {\n    var url, response;\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            url = BASE_URL + '/' + id;\n            _context3.prev = 1;\n            _context3.next = 4;\n            return instance.get(url);\n\n          case 4:\n            response = _context3.sent;\n            return _context3.abrupt(\"return\", response.class.class);\n\n          case 8:\n            _context3.prev = 8;\n            _context3.t0 = _context3[\"catch\"](1);\n            throw _context3.t0;\n\n          case 11:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[1, 8]]);\n  }));\n\n  return function getObject(_x4) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var getObjectPermissions =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee4(id) {\n    var url, response;\n    return regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            url = BASE_URL + '/' + id + '/acl';\n            _context4.prev = 1;\n            _context4.next = 4;\n            return instance.get(url);\n\n          case 4:\n            response = _context4.sent;\n            return _context4.abrupt(\"return\", coerceObjectPermissionsResponse(response));\n\n          case 8:\n            _context4.prev = 8;\n            _context4.t0 = _context4[\"catch\"](1);\n            throw _context4.t0;\n\n          case 11:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[1, 8]]);\n  }));\n\n  return function getObjectPermissions(_x5) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var patchObjectPermissions =\n/*#__PURE__*/\nfunction () {\n  var _ref5 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee5(id, item) {\n    var url;\n    return regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            url = BASE_URL + '/' + id + '/acl';\n            _context5.prev = 1;\n            _context5.next = 4;\n            return instance.patch(url, {\n              changes: item\n            });\n\n          case 4:\n            eventBus.$emit('notificationInfo', 'Sucessfully updated');\n            _context5.next = 10;\n            break;\n\n          case 7:\n            _context5.prev = 7;\n            _context5.t0 = _context5[\"catch\"](1);\n            throw _context5.t0;\n\n          case 10:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, null, [[1, 7]]);\n  }));\n\n  return function patchObjectPermissions(_x6, _x7) {\n    return _ref5.apply(this, arguments);\n  };\n}();\nexport var coerceObjectPermissionsResponse = function coerceObjectPermissionsResponse(response) {\n  var formattedResponse = [];\n\n  if (response.list) {\n    // format response before assignment\n    formattedResponse = response.list.map(function (item) {\n      return {\n        grantee: {\n          id: item.grantee.id,\n          name: item.grantee.name\n        },\n        access: {\n          c: item.privileges.includes('CREATE'),\n          r: item.privileges.includes('SELECT'),\n          u: item.privileges.includes('UPDATE'),\n          d: item.privileges.includes('DELETE')\n        }\n      };\n    });\n  }\n\n  return formattedResponse;\n};",{"version":3,"sources":["/home/dev/work/client-auth/src/api/permissions/objects/objects.js"],"names":["instance","eventBus","BASE_URL","getObjectList","search","defaultObject","class","obac","rbac","id","url","get","response","classes","map","item","updateObject","updatedItem","put","$emit","getObject","getObjectPermissions","coerceObjectPermissionsResponse","patchObjectPermissions","patch","changes","formattedResponse","list","grantee","name","access","c","privileges","includes","r","u","d"],"mappings":"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","sourcesContent":["import instance from '../../instance';\nimport eventBus from \"../../../utils/eventBus\";\n\nconst BASE_URL = '/objects';\n\nexport const getObjectList = async (search) => {\n    const defaultObject = {  // default object prototype, to merge response with it to get all fields\n        class: '',\n        obac: false,\n        rbac: false,\n        id: 0\n    };\n\n    let url = BASE_URL;\n    if(search) url += `name='${search}*`;\n\n    try {\n        const response = await instance.get(url);\n        return response.classes.map(item => {\n            return {...defaultObject, ...item};\n        });\n    } catch (error) {\n        throw error;\n    }\n};\n\nexport const updateObject = async (id, item) => {\n    const url = BASE_URL + '/' + id;\n    const updatedItem = {\n        class: {\n            obac: item.obac,\n            rbac: item.rbac\n        }\n    };\n\n    try {\n        await instance.put(url, updatedItem);\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (error) {\n        throw error;\n    }\n};\n\nexport const getObject = async (id) => {\n    const url = BASE_URL + '/' + id;\n    try {\n        const response = await instance.get(url);\n        return response.class.class;\n    } catch (error) {\n        throw error;\n    }\n};\n\nexport const getObjectPermissions = async (id) => {\n    const url = BASE_URL + '/' + id + '/acl';\n\n    try {\n        const response = await instance.get(url);\n        return coerceObjectPermissionsResponse(response);\n    } catch (error) {\n        throw error;\n    }\n};\n\nexport const patchObjectPermissions = async (id, item) => {\n    const url = BASE_URL + '/' + id + '/acl';\n\n    try {\n        await instance.patch(url, {changes: item});\n        eventBus.$emit('notificationInfo', 'Sucessfully updated');\n    } catch (error) {\n        throw error;\n    }\n};\n\nexport const coerceObjectPermissionsResponse = (response) => {\n    let formattedResponse = [];\n    if (response.list) {\n        // format response before assignment\n        formattedResponse = response.list.map(item => {\n            return {\n                grantee: {\n                    id: item.grantee.id,\n                    name: item.grantee.name\n                },\n                access: {\n                    c: item.privileges.includes('CREATE'),\n                    r: item.privileges.includes('SELECT'),\n                    u: item.privileges.includes('UPDATE'),\n                    d: item.privileges.includes('DELETE'),\n                }\n            }\n        });\n    }\n    return formattedResponse;\n};"]}]}