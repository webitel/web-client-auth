{"remainingRequest":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js!/home/dev/work/client-auth/src/api/lookups/media/media.js","dependencies":[{"path":"/home/dev/work/client-auth/src/api/lookups/media/media.js","mtime":1580915489202},{"path":"/home/dev/work/client-auth/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dev/work/client-auth/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/dev/work/client-auth/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport instance from \"../../instance\";\nimport axios from 'axios';\nimport configuration from \"../../openAPIConfig\";\nimport { MediaFileServiceApiFactory } from 'webitel-sdk';\nimport eventBus from \"../../../utils/eventBus\";\nimport store from \"../../../store/store\";\nvar mediaService = new MediaFileServiceApiFactory(configuration, '', instance);\nvar token = localStorage.getItem('access-token');\nvar BASE_URL = process.env.VUE_APP_API_URL;\nexport var getMediaList =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee() {\n    var page,\n        size,\n        search,\n        domainId,\n        defaultObject,\n        response,\n        _args = arguments;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            page = _args.length > 0 && _args[0] !== undefined ? _args[0] : 0;\n            size = _args.length > 1 && _args[1] !== undefined ? _args[1] : 10;\n            search = _args.length > 2 ? _args[2] : undefined;\n            domainId = store.state.userinfo.domainId || undefined;\n            if (search && search.slice(-1) !== '*') search += '*';\n            defaultObject = {\n              name: '',\n              _isSelected: false\n            };\n            _context.prev = 6;\n            _context.next = 9;\n            return mediaService.searchMediaFile(page, size, search, domainId);\n\n          case 9:\n            response = _context.sent;\n\n            if (!response.items) {\n              _context.next = 12;\n              break;\n            }\n\n            return _context.abrupt(\"return\", response.items.map(function (item) {\n              return _objectSpread({}, defaultObject, {}, item);\n            }));\n\n          case 12:\n            return _context.abrupt(\"return\", []);\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](6);\n            throw _context.t0;\n\n          case 18:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[6, 15]]);\n  }));\n\n  return function getMediaList() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var getMedia =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee2(id) {\n    var url, domainId;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            url = \"\".concat(BASE_URL, \"/storage/media/\").concat(id, \"/stream?access_token=\").concat(token);\n            domainId = store.state.userinfo.domainId || undefined;\n            _context2.prev = 2;\n            _context2.next = 5;\n            return instance.get(url, domainId);\n\n          case 5:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](2);\n            throw _context2.t0;\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[2, 8]]);\n  }));\n\n  return function getMedia(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var downloadMedia =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee3(id) {\n    var url;\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            url = \"\".concat(BASE_URL, \"/storage/media/\").concat(id, \"/download?access_token=\").concat(token);\n            _context3.prev = 1;\n            _context3.next = 4;\n            return instance.get(url);\n\n          case 4:\n            return _context3.abrupt(\"return\", _context3.sent);\n\n          case 7:\n            _context3.prev = 7;\n            _context3.t0 = _context3[\"catch\"](1);\n            throw _context3.t0;\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[1, 7]]);\n  }));\n\n  return function downloadMedia(_x2) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var addMedia =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee4(file) {\n    var url, config, formData, response;\n    return regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            url = \"\".concat(BASE_URL, \"/storage/media?access_token=\").concat(token);\n            config = {\n              headers: {\n                'content-type': 'multipart/form-data'\n              }\n            };\n            formData = new FormData();\n            formData.append('file', file);\n            _context4.prev = 4;\n            _context4.next = 7;\n            return axios.post(url, formData, config);\n\n          case 7:\n            response = _context4.sent;\n            eventBus.$emit('notificationInfo', 'Sucessfully added');\n            return _context4.abrupt(\"return\", response.id);\n\n          case 12:\n            _context4.prev = 12;\n            _context4.t0 = _context4[\"catch\"](4);\n            throw _context4.t0;\n\n          case 15:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[4, 12]]);\n  }));\n\n  return function addMedia(_x3) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var deleteMedia =\n/*#__PURE__*/\nfunction () {\n  var _ref5 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee5(id) {\n    var domainId;\n    return regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            domainId = store.state.userinfo.domainId || undefined;\n            _context5.prev = 1;\n            _context5.next = 4;\n            return mediaService.deleteMediaFile(id, domainId);\n\n          case 4:\n            _context5.next = 9;\n            break;\n\n          case 6:\n            _context5.prev = 6;\n            _context5.t0 = _context5[\"catch\"](1);\n            throw _context5.t0;\n\n          case 9:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, null, [[1, 6]]);\n  }));\n\n  return function deleteMedia(_x4) {\n    return _ref5.apply(this, arguments);\n  };\n}();",{"version":3,"sources":["/home/dev/work/client-auth/src/api/lookups/media/media.js"],"names":["instance","axios","configuration","MediaFileServiceApiFactory","eventBus","store","mediaService","token","localStorage","getItem","BASE_URL","process","env","VUE_APP_API_URL","getMediaList","page","size","search","domainId","state","userinfo","undefined","slice","defaultObject","name","_isSelected","searchMediaFile","response","items","map","item","getMedia","id","url","get","downloadMedia","addMedia","file","config","headers","formData","FormData","append","post","$emit","deleteMedia","deleteMediaFile"],"mappings":"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","sourcesContent":["import instance from '../../instance';\nimport axios from 'axios';\nimport configuration from '../../openAPIConfig';\nimport {MediaFileServiceApiFactory} from 'webitel-sdk';\nimport eventBus from \"../../../utils/eventBus\";\nimport store from \"../../../store/store\";\n\nconst mediaService = new MediaFileServiceApiFactory\n(configuration, '', instance);\n\nconst token = localStorage.getItem('access-token');\nconst BASE_URL = process.env.VUE_APP_API_URL;\n\nexport const getMediaList = async (page = 0, size = 10, search) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    if(search && search.slice(-1) !== '*') search += '*';\n    const defaultObject = {\n        name: '',\n        _isSelected: false,\n    };\n\n    try {\n        let response = await mediaService.searchMediaFile(page, size, search, domainId);\n        if (response.items) {\n            return response.items.map(item => {\n                return {...defaultObject, ...item};\n            });\n        }\n        return [];\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const getMedia = async (id) => {\n    const url = `${BASE_URL}/storage/media/${id}/stream?access_token=${token}`;\n    const domainId = store.state.userinfo.domainId || undefined;\n    try {\n        return await instance.get(url, domainId);\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const downloadMedia = async (id) => {\n    const url = `${BASE_URL}/storage/media/${id}/download?access_token=${token}`;\n    try {\n        return await instance.get(url);\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const addMedia = async (file) => {\n    const url = `${BASE_URL}/storage/media?access_token=${token}`;\n    const config = {\n        headers: {\n            'content-type': 'multipart/form-data'\n        }\n    };\n    const formData = new FormData();\n    formData.append('file', file);\n    try {\n        const response = await axios.post(url, formData, config);\n        eventBus.$emit('notificationInfo', 'Sucessfully added');\n        return response.id;\n    } catch (err) {\n        throw err;\n    }\n};\n\nexport const deleteMedia = async (id) => {\n    const domainId = store.state.userinfo.domainId || undefined;\n    try {\n        await mediaService.deleteMediaFile(id, domainId);\n    } catch (err) {\n        throw err;\n    }\n};"]}]}